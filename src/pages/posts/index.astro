---
import { getCollection } from 'astro:content';
import MainLayout from '../../layouts/MainLayout.astro';

const posts = await getCollection('blog');

// Buat objek untuk mengelompokkan post berdasarkan kategori
const postsByCategory = posts.reduce((acc, post) => {
  const { category } = post.data;
  if (!acc[category]) {
    acc[category] = [];
  }
  acc[category].push(post);
  return acc;
}, {} as Record<string, typeof posts>);

const categories = Object.keys(postsByCategory).sort();
---

<MainLayout
  title="All Categories"
  description="Browse writeups and articles by category."
>
  <div class="container">
    <h1>All Categories</h1>
    <div class="category-list">
      {categories.map(category => (
        <section class="category-section">
          <h2><a href={`/posts/${category.toLowerCase().replace(/ /g, '-')}`}>{category}</a></h2>
          <p>{postsByCategory[category].length} Posts</p>
        </section>
      ))}
    </div>
  </div>
</MainLayout>

<style>
  .container { max-width: 800px; margin: 0 auto; padding: 2rem 1rem; }
  h1 { font-size: 2.5rem; margin-bottom: 2rem; }
  .category-list { display: grid; gap: 1rem; }
  .category-section {
    border: 1px solid var(--divider-color);
    padding: 1.5rem;
    border-radius: 8px;
    transition: background-color 0.2s;
  }
  .category-section:hover { background-color: rgba(255, 255, 255, 0.05); }
  .category-section h2 { margin: 0; font-size: 1.5rem; }
  .category-section h2 a { color: inherit; text-decoration: none; }
  .category-section p { margin: 0.25rem 0 0; opacity: 0.7; }
</style>